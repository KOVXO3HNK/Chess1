# Telegram Chess Web App

Одностраничное Telegram Web App-приложение с шахматной доской, игрой против ИИ, локальным мультиплеером, квестами и профилем игрока.

## Структура проекта

- `public/index.html` — основной HTML, подключающий скрипты и стили.
- `public/styles.css` — оформление интерфейса в фирменном стиле.
- `public/app.js` — логика приложения: работа с шахматным движком, интерфейсом и Telegram API.
- `public/telegram-web-app.js` — обёртка над Telegram Web App API с обработкой темы и кнопок.
- `public/chess.js` — библиотека [chess.js](https://github.com/jhlywa/chess.js) в виде ES-модуля.
- `public/manifest.json` — PWA-манифест для корректного отображения и иконок.
- `render.yaml` — конфигурация сервиса Render для автоматического деплоя статических файлов из каталога `public/`.

### Откуда взялся Peggy?

В начале файла `public/chess.js` есть пометка «@generated by Peggy». Peggy — это современное название проекта PEG.js, парсер-генератора,
которым разработчики chess.js собирают готовый модуль из грамматики. Никаких дополнительных зависимостей подключать не нужно:
в репозитории уже лежит сгенерированный итоговый файл движка.

## Запуск локально

1. Установите любой статический сервер. Например:
   ```bash
   npm install -g serve
   ```
2. Запустите сервер, указывая каталог `public/`:
   ```bash
   serve public
   ```
   или воспользуйтесь стандартным Python-сервером:
   ```bash
   python -m http.server 5173 --directory public
   ```
3. Откройте в браузере `http://localhost:5173` (укажите порт вашего сервера).

## Деплой на Render

1. Залогиньтесь в Render и подключите репозиторий через кнопку **New + → Static Site**.
2. При создании сервиса Render автоматически подхватит файл `render.yaml`. Убедитесь, что выбран режим **Use Render YAML** и указан нужный коммит/ветка.
3. Нажмите **Create Static Site** — Render создаст сервис и задеплоит файлы из каталога `public/` без дополнительной сборки.
4. После успешного деплоя в разделе **Settings → Custom Domains** добавьте собственный домен (по желанию) или используйте домен вида `https://<project>.onrender.com`.
5. Каждый новый пуш в основную ветку автоматически перезапустит деплой благодаря `render.yaml`.

## Привязка Web App к Telegram

1. Возьмите HTTPS-URL, который выдал Render (или собственный домен, привязанный на предыдущем шаге).
2. В BotFather выполните команду `/setdomain` и укажите этот URL, либо откройте настройки кнопки **Web App** и вставьте ссылку в поле **Web App URL**.
3. Обновите, при необходимости, `manifest.json`, фавиконки и картинки, чтобы они соответствовали бренду бота.
4. После сохранения настроек перезапустите чат с ботом. Кнопка Web App начнёт открывать развёрнутое приложение на Render.

## Известные ограничения

- Игра с реальными соперниками реализована только в режиме "за одним устройством" (приглашение отправляется ссылкой/сообщением).
- Для игры против ИИ используется встроенный минимакс с эвристикой, поэтому глубина ограничена 3 полуходами.

Приложение не требует сборки, работает сразу после публикации статических файлов.
